from switch import *
from sys import argv
"""show cdp neighbors detail
-------------------------
Device ID: c9200-sw7.gsprom.local
Entry address(es):
  IP address: 172.16.215.201
Platform: cisco C9200L-48P-4G,  Capabilities: Switch IGMP
Interface: GigabitEthernet1/0/16,  Port ID (outgoing port): GigabitEthernet1/0/48
Holdtime : 163 sec

Version :
Cisco IOS Software [Fuji], Catalyst L3 Switch Software (CAT9K_LITE_IOSXE), Version 16.9.3, RELEASE SOFTWARE (fc2)
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 1986-2019 by Cisco Systems, Inc.
Compiled Wed 20-Mar-19 07:28 by mcpre

advertisement version: 2
VTP Management Domain: ''
Native VLAN: 1
Duplex: full
Management address(es):
  IP address: 172.16.215.201

-------------------------
Device ID: c9200-sw7.gsprom.local
Entry address(es):
  IP address: 172.16.215.201
Platform: cisco C9200L-48P-4G,  Capabilities: Switch IGMP
Interface: GigabitEthernet2/0/16,  Port ID (outgoing port): GigabitEthernet1/0/47
Holdtime : 166 sec

Version :
Cisco IOS Software [Fuji], Catalyst L3 Switch Software (CAT9K_LITE_IOSXE), Version 16.9.3, RELEASE SOFTWARE (fc2)
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 1986-2019 by Cisco Systems, Inc.
Compiled Wed 20-Mar-19 07:28 by mcpre

advertisement version: 2
VTP Management Domain: ''
Native VLAN: 1
Duplex: full
Management address(es):
  IP address: 172.16.215.201

-------------------------
Device ID: C4331_GSP-Servis.gsprom.local
Entry address(es):
  IP address: 172.17.8.62
Platform: cisco ISR4331/K9,  Capabilities: Router Switch IGMP
Interface: GigabitEthernet2/0/24,  Port ID (outgoing port): GigabitEthernet0/0/0
Holdtime : 160 sec

Version :
Cisco IOS Software [Fuji], ISR Software (X86_64_LINUX_IOSD-UNIVERSALK9-M), Version 16.9.3, RELEASE SOFTWARE (fc2)
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 1986-2019 by Cisco Systems, Inc.
Compiled Wed 20-Mar-19 08:02 by mcpre

advertisement version: 2
VTP Management Domain: ''
Duplex: full
Management address(es):
  IP address: 172.17.8.62

-------------------------
Device ID: C4331_GSP-Servis.gsprom.local
Entry address(es):
  IP address: 172.17.8.62
Platform: cisco ISR4331/K9,  Capabilities: Router Switch IGMP
Interface: GigabitEthernet1/0/24,  Port ID (outgoing port): GigabitEthernet0/0/1
Holdtime : 158 sec

Version :
Cisco IOS Software [Fuji], ISR Software (X86_64_LINUX_IOSD-UNIVERSALK9-M), Version 16.9.3, RELEASE SOFTWARE (fc2)
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 1986-2019 by Cisco Systems, Inc.
Compiled Wed 20-Mar-19 08:02 by mcpre

advertisement version: 2
VTP Management Domain: ''
Duplex: full
Management address(es):
  IP address: 172.17.8.62

-------------------------
Device ID: c2960_sw3-video.gsprom.local
Entry address(es):
  IP address: 172.16.215.197
Platform: cisco WS-C2960X-48FPS-L,  Capabilities: Switch IGMP
Interface: GigabitEthernet1/0/20,  Port ID (outgoing port): GigabitEthernet1/0/47
Holdtime : 161 sec

Version :
Cisco IOS Software, C2960X Software (C2960X-UNIVERSALK9-M), Version 15.2(4)E8, RELEASE SOFTWARE (fc3)
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 1986-2019 by Cisco Systems, Inc.
Compiled Fri 15-Mar-19 10:55 by prod_rel_team

advertisement version: 2
VTP Management Domain: ''
Native VLAN: 1
Duplex: full
Management address(es):
  IP address: 172.16.215.197

-------------------------
Device ID: c2960_sw3-video.gsprom.local
Entry address(es):
  IP address: 172.16.215.197
Platform: cisco WS-C2960X-48FPS-L,  Capabilities: Switch IGMP
Interface: GigabitEthernet2/0/20,  Port ID (outgoing port): GigabitEthernet1/0/48
Holdtime : 121 sec

Version :
Cisco IOS Software, C2960X Software (C2960X-UNIVERSALK9-M), Version 15.2(4)E8, RELEASE SOFTWARE (fc3)
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 1986-2019 by Cisco Systems, Inc.
Compiled Fri 15-Mar-19 10:55 by prod_rel_team

advertisement version: 2
VTP Management Domain: ''
Native VLAN: 1
Duplex: full
Management address(es):
  IP address: 172.16.215.197

-------------------------
Device ID: sw2960-spb-nekrasova14a.2.14.gsprom.loca
Entry address(es):
  IP address: 172.25.2.14
Platform: cisco WS-C2960-48TC-L,  Capabilities: Switch IGMP
Interface: GigabitEthernet2/0/17,  Port ID (outgoing port): GigabitEthernet0/1
Holdtime : 154 sec

Version :
Cisco IOS Software, C2960 Software (C2960-LANBASEK9-M), Version 12.2(53)SE1, RELEASE SOFTWARE (fc2)
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 1986-2010 by Cisco Systems, Inc.
Compiled Fri 12-Mar-10 17:38 by prod_rel_team

advertisement version: 2
Protocol Hello:  OUI=0x00000C, Protocol ID=0x0112; payload len=27, value=00000000FFFFFFFF010221FF0000000000000025B45D1B00FF0000
VTP Management Domain: 'gsprom'
Native VLAN: 1
Duplex: full
Management address(es):
  IP address: 172.25.2.14

-------------------------
Device ID: c2960_sw4.gsprom.local
Entry address(es):
  IP address: 172.16.215.198
Platform: cisco WS-C2960X-48FPS-L,  Capabilities: Switch IGMP
Interface: GigabitEthernet2/0/21,  Port ID (outgoing port): GigabitEthernet1/0/48
Holdtime : 159 sec

Version :
Cisco IOS Software, C2960X Software (C2960X-UNIVERSALK9-M), Version 15.2(4)E8, RELEASE SOFTWARE (fc3)
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 1986-2019 by Cisco Systems, Inc.
Compiled Fri 15-Mar-19 10:55 by prod_rel_team

advertisement version: 2
VTP Management Domain: ''
Native VLAN: 1
Duplex: full
Management address(es):
  IP address: 172.16.215.198

-------------------------
Device ID: c2960_sw4.gsprom.local
Entry address(es):
  IP address: 172.16.215.198
Platform: cisco WS-C2960X-48FPS-L,  Capabilities: Switch IGMP
Interface: GigabitEthernet1/0/21,  Port ID (outgoing port): GigabitEthernet1/0/47
Holdtime : 173 sec

Version :
Cisco IOS Software, C2960X Software (C2960X-UNIVERSALK9-M), Version 15.2(4)E8, RELEASE SOFTWARE (fc3)
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 1986-2019 by Cisco Systems, Inc.
Compiled Fri 15-Mar-19 10:55 by prod_rel_team

advertisement version: 2
VTP Management Domain: ''
Native VLAN: 1
Duplex: full
Management address(es):
  IP address: 172.16.215.198

-------------------------
Device ID: c2960_sw5.gsprom.local
Entry address(es):
  IP address: 172.16.215.199
Platform: cisco WS-C2960X-48FPS-L,  Capabilities: Switch IGMP
Interface: GigabitEthernet2/0/22,  Port ID (outgoing port): GigabitEthernet1/0/48
Holdtime : 176 sec

Version :
Cisco IOS Software, C2960X Software (C2960X-UNIVERSALK9-M), Version 15.2(4)E8, RELEASE SOFTWARE (fc3)
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 1986-2019 by Cisco Systems, Inc.
Compiled Fri 15-Mar-19 10:55 by prod_rel_team

advertisement version: 2
VTP Management Domain: ''
Native VLAN: 1
Duplex: full
Management address(es):
  IP address: 172.16.215.199

-------------------------
Device ID: c2960_sw5.gsprom.local
Entry address(es):
  IP address: 172.16.215.199
Platform: cisco WS-C2960X-48FPS-L,  Capabilities: Switch IGMP
Interface: GigabitEthernet1/0/22,  Port ID (outgoing port): GigabitEthernet1/0/47
Holdtime : 170 sec

Version :
Cisco IOS Software, C2960X Software (C2960X-UNIVERSALK9-M), Version 15.2(4)E8, RELEASE SOFTWARE (fc3)
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 1986-2019 by Cisco Systems, Inc.
Compiled Fri 15-Mar-19 10:55 by prod_rel_team

advertisement version: 2
VTP Management Domain: ''
Native VLAN: 1
Duplex: full
Management address(es):
  IP address: 172.16.215.199

-------------------------
Device ID: c2960_sw6.gsprom.local
Entry address(es):
  IP address: 172.16.215.200
Platform: cisco WS-C2960X-48FPS-L,  Capabilities: Switch IGMP
Interface: GigabitEthernet1/0/23,  Port ID (outgoing port): GigabitEthernet1/0/48
Holdtime : 124 sec

Version :
Cisco IOS Software, C2960X Software (C2960X-UNIVERSALK9-M), Version 15.2(4)E8, RELEASE SOFTWARE (fc3)
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 1986-2019 by Cisco Systems, Inc.
Compiled Fri 15-Mar-19 10:55 by prod_rel_team

advertisement version: 2
VTP Management Domain: ''
Native VLAN: 1
Duplex: full
Management address(es):
  IP address: 172.16.215.200

-------------------------
Device ID: c2960_sw6.gsprom.local
Entry address(es):
  IP address: 172.16.215.200
Platform: cisco WS-C2960X-48FPS-L,  Capabilities: Switch IGMP
Interface: GigabitEthernet2/0/23,  Port ID (outgoing port): GigabitEthernet1/0/47
Holdtime : 175 sec

Version :
Cisco IOS Software, C2960X Software (C2960X-UNIVERSALK9-M), Version 15.2(4)E8, RELEASE SOFTWARE (fc3)
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 1986-2019 by Cisco Systems, Inc.
Compiled Fri 15-Mar-19 10:55 by prod_rel_team

advertisement version: 2
VTP Management Domain: ''
Native VLAN: 1
Duplex: full
Management address(es):
  IP address: 172.16.215.200

-------------------------
Device ID: c2960_sw1.gsprom.local
Entry address(es):
  IP address: 172.16.215.195
Platform: cisco WS-C2960X-48FPS-L,  Capabilities: Switch IGMP
Interface: GigabitEthernet2/0/18,  Port ID (outgoing port): GigabitEthernet1/0/48
Holdtime : 129 sec

Version :
Cisco IOS Software, C2960X Software (C2960X-UNIVERSALK9-M), Version 15.2(4)E8, RELEASE SOFTWARE (fc3)
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 1986-2019 by Cisco Systems, Inc.
Compiled Fri 15-Mar-19 10:55 by prod_rel_team

advertisement version: 2
VTP Management Domain: ''
Native VLAN: 1
Duplex: full
Management address(es):
  IP address: 172.16.215.195

-------------------------
Device ID: c2960_sw1.gsprom.local
Entry address(es):
  IP address: 172.16.215.195
Platform: cisco WS-C2960X-48FPS-L,  Capabilities: Switch IGMP
Interface: GigabitEthernet1/0/18,  Port ID (outgoing port): GigabitEthernet1/0/47
Holdtime : 164 sec

Version :
Cisco IOS Software, C2960X Software (C2960X-UNIVERSALK9-M), Version 15.2(4)E8, RELEASE SOFTWARE (fc3)
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 1986-2019 by Cisco Systems, Inc.
Compiled Fri 15-Mar-19 10:55 by prod_rel_team

advertisement version: 2
VTP Management Domain: ''
Native VLAN: 1
Duplex: full
Management address(es):
  IP address: 172.16.215.195

-------------------------
Device ID: c2960_sw2.gsprom.local
Entry address(es):
  IP address: 172.16.215.196
Platform: cisco WS-C2960X-48FPS-L,  Capabilities: Switch IGMP
Interface: GigabitEthernet2/0/19,  Port ID (outgoing port): GigabitEthernet1/0/48
Holdtime : 131 sec

Version :
Cisco IOS Software, C2960X Software (C2960X-UNIVERSALK9-M), Version 15.2(4)E8, RELEASE SOFTWARE (fc3)
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 1986-2019 by Cisco Systems, Inc.
Compiled Fri 15-Mar-19 10:55 by prod_rel_team

advertisement version: 2
VTP Management Domain: ''
Native VLAN: 1
Duplex: full
Management address(es):
  IP address: 172.16.215.196

-------------------------
Device ID: c2960_sw2.gsprom.local
Entry address(es):
  IP address: 172.16.215.196
Platform: cisco WS-C2960X-48FPS-L,  Capabilities: Switch IGMP
Interface: GigabitEthernet1/0/19,  Port ID (outgoing port): GigabitEthernet1/0/47
Holdtime : 152 sec

Version :
Cisco IOS Software, C2960X Software (C2960X-UNIVERSALK9-M), Version 15.2(4)E8, RELEASE SOFTWARE (fc3)
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 1986-2019 by Cisco Systems, Inc.
Compiled Fri 15-Mar-19 10:55 by prod_rel_team

advertisement version: 2
VTP Management Domain: ''
Native VLAN: 1
Duplex: full
Management address(es):
  IP address: 172.16.215.196


Total cdp entries displayed : 17
c3850-core-gsp-serv#
"""
# input("1!!")
switchIP = argv[1]
# input("2!!")
# getLoginsFrom(fileWithLogins)
ssh = connectTo(switchIP)

# input("3!!")
commandWithoutData("terminal length 0", ssh)
# input("4!!")
for neighbor in commandWithData("show cdp neighbors detail", ssh).split("-------------------------"):
    oneSwitch = False
    # remoteSwitch = ""
    # print(remoteSwitch)
    # interface = list()
    # print(neighbor)
    #if not re.findall(r"show cdp neighbors detail",neighbor):
    for line in neighbor.split("\r\n"):
        if re.findall(r"IP address:",line) and not oneSwitch:
            remoteSwitch = line.split(":")[1].replace(" ","")
            oneSwitch = True
        if re.findall(r"Interface:",line) and re.findall(r"Port ID", line):
            interface = [line.split(",")[0].split(":")[1].replace(" ","") , line.split(",")[1].split(":")[1].replace(" ","")]
    if oneSwitch:        
        print(interface[0] + " to " + interface[1] + " sw " + remoteSwitch)
    #print(interface[0])

input('Success!')